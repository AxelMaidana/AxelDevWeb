<nav
    id="main-nav"
    class="fixed top-0 left-0 w-full z-50 flex justify-center pointer-events-none"
>
    <div
        id="nav-inner"
        class="nav-content w-full max-w-screen-xl px-6 py-4 flex items-center justify-between pointer-events-auto transition-colors duration-300"
    >
        <!-- Logo -->
        <div id="nav-logo" class="flex items-center gap-2 group cursor-pointer">
            <a href="#" class="flex items-center gap-2">
                <div
                    class="w-6 h-6 bg-indigo-500/20 border border-indigo-500/30 rounded flex items-center justify-center text-indigo-400"
                >
                    <span class="font-mono text-xs font-bold">/</span>
                </div>
                <span
                    class="text-sm font-medium text-white tracking-tight group-hover:text-indigo-300 transition-colors"
                    >Dev.Identity</span
                >
            </a>
        </div>

        <!-- Links (Hidden mobile) -->
        <div id="nav-links" class="hidden md:flex items-center gap-6">
            <a
                href="#stack"
                class="text-xs font-medium text-slate-400 hover:text-white transition-colors"
                >Stack</a
            >
            <a
                href="#projects"
                class="text-xs font-medium text-slate-400 hover:text-white transition-colors"
                >Proyectos</a
            >
            <a
                href="#pricing"
                class="text-xs font-medium text-slate-400 hover:text-white transition-colors"
                >Servicios</a
            >
        </div>

        <!-- CTA -->
        <div id="nav-cta">
            <a
                href="#contact"
                class="hidden sm:flex items-center gap-2 bg-white text-black px-4 py-1.5 rounded-full text-xs font-medium hover:bg-slate-200 transition-colors"
            >
                <span>Contactar</span>
                <iconify-icon icon="solar:arrow-right-linear"></iconify-icon>
            </a>

            <!-- Mobile Menu Icon -->
            <button class="md:hidden text-white">
                <iconify-icon icon="solar:hamburger-menu-linear" class="text-xl"
                ></iconify-icon>
            </button>
        </div>
    </div>
</nav>

<style>
    #main-nav {
        transform: translateZ(0);
    }
</style>

<script>
    import { gsap } from "gsap";
    import { ScrollTrigger } from "gsap/ScrollTrigger";

    gsap.registerPlugin(ScrollTrigger);

    function initNavAnimation() {
        const navInner = document.getElementById("nav-inner");
        const navLogo = document.getElementById("nav-logo");
        const navLinks = document.getElementById("nav-links");
        const navCTA = document.getElementById("nav-cta");

        if (!navInner) return;

        let mm = gsap.matchMedia();

        mm.add("(min-width: 768px)", () => {
            // Desktop Animation
            gsap.to(navInner, {
                maxWidth: "600px",
                marginTop: "1.25rem",
                padding: "0.6rem 1.25rem",
                borderRadius: "9999px",
                backgroundColor: "rgba(5, 5, 5, 0.7)",
                backdropFilter: "blur(5px)",
                boxShadow: "0 20px 40px -15px rgba(0, 0, 0, 0.7)",
                ease: "none",
                scrollTrigger: {
                    trigger: "body",
                    start: "top -10",
                    end: "top -100",
                    scrub: 0.5,
                },
            });

            gsap.to(navLogo, {
                x: 5,
                ease: "none",
                scrollTrigger: {
                    trigger: "body",
                    start: "top -10",
                    end: "top -100",
                    scrub: 0.5,
                },
            });

            gsap.to(navCTA, {
                x: -5,
                ease: "none",
                scrollTrigger: {
                    trigger: "body",
                    start: "top -10",
                    end: "top -100",
                    scrub: 0.5,
                },
            });
        });

        mm.add("(max-width: 767px)", () => {
            // Mobile Animation
            gsap.to(navInner, {
                maxWidth: "92%",
                marginTop: "1rem",
                padding: "0.5rem 1rem",
                borderRadius: "9999px",
                backgroundColor: "rgba(5, 5, 5, 0.8)",
                backdropFilter: "blur(12px)",
                ease: "none",
                scrollTrigger: {
                    trigger: "body",
                    start: "top -10",
                    end: "top -50",
                    scrub: 0.5,
                },
            });
        });
    }

    initNavAnimation();

    document.addEventListener("astro:page-load", initNavAnimation);
</script>
